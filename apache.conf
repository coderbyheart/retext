<VirtualHost *:80>

        ServerName api.retext.it
        ServerAlias api.retext.nanshe.tacker.lan

        ServerAdmin hosting@coderbyheart.de

        UseCanonicalName On

        DocumentRoot /data/www/retext-server/web

        <Directory /data/www/retext-server/web>
                AllowOverride All
                Options -Indexes FollowSymLinks

                Order allow,deny
                Allow from all

                # Use UTF-8 encoding for anything served text/plain or text/html
                AddDefaultCharset utf-8

                # Increase cookie security
                php_value session.cookie_httponly true

                # URL rewrites
                RewriteEngine On
                DirectoryIndex app.php
                RewriteCond %{REQUEST_FILENAME} !-f
                RewriteCond %{REQUEST_FILENAME} !-d
                RewriteRule . /app.php [L]

                # Allow Ajax Request from everywhere
                SetEnvIf Origin "http://app\.retext\.nanshe\.tacker\.lan$" AccessControlAllowOrigin=$0
                SetEnvIf Origin "http://app\.retext\.it$" AccessControlAllowOrigin=$0
                Header set X-HOST %{Origin}e env=Origin
                Header set Access-Control-Allow-Origin %{AccessControlAllowOrigin}e env=AccessControlAllowOrigin
                Header set Access-Control-Allow-Credentials "true"
                Header set Access-Control-Max-Age "604800"
                Header set Access-Control-Allow-Methods "GET,POST,PUT,DELETE,OPTIONS"
                Header set Access-Control-Allow-Headers "X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version"

        </Directory>
</VirtualHost>

